<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Campus Life Planner</title>
    <meta name="description"
          content="A comprehensive campus life planner to organize your academic schedule, events, and campus activities">
    <meta name="keywords" content="campus, planner, schedule, academic, student, university">

    <!-- CSS Links -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* Complete CSS - All styles included here */
        :root {
            --primary-color: #4361ee;
            --primary-dark: #3a56d4;
            --secondary-color: #7209b7;
            --accent-color: #4cc9f0;
            --success-color: #06d6a0;
            --warning-color: #ffd166;
            --danger-color: #ef476f;
            --light-bg: #f8f9fa;
            --card-bg: #ffffff;
            --text-dark: #2b2d42;
            --text-light: #6c757d;
            --border-color: #e9ecef;
            --sidebar-width: 260px;
            --header-height: 70px;
            --border-radius: 12px;
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-md: 0 4px 20px rgba(0,0,0,0.12);
            --shadow-lg: 0 8px 40px rgba(0,0,0,0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--light-bg);
            color: var(--text-dark);
            display: flex;
            min-height: 100vh;
        }

        /* Skip Link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--primary-color);
            color: white;
            padding: 8px;
            text-decoration: none;
            border-radius: var(--border-radius);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .skip-link:focus {
            top: 6px;
        }

        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 2rem 1.5rem 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .sidebar-header p {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        .nav-menu {
            list-style: none;
            padding: 1rem 0;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            color: rgba(255,255,255,0.9);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(255,255,255,0.1);
            color: white;
            border-left-color: var(--accent-color);
        }

        .nav-icon {
            margin-right: 1rem;
            font-size: 1.2rem;
            width: 20px;
            text-align: center;
        }

        /* Main Content Area */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            min-height: 100vh;
        }

        .top-header {
            height: var(--header-height);
            background: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            border-radius: var(--border-radius);
            cursor: pointer;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .page-content {
            padding: 2rem;
        }

        /* Dashboard Styles */
        .dashboard-header {
            margin-bottom: 2rem;
        }

        .dashboard-header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .dashboard-header p {
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            border-left: 4px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }

        .stat-card.warning {
            border-left-color: var(--warning-color);
        }

        .stat-card.success {
            border-left-color: var(--success-color);
        }

        .stat-card.danger {
            border-left-color: var(--danger-color);
        }

        .stat-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: rgba(67, 97, 238, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-right: 1rem;
        }

        .stat-content {
            flex: 1;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-dark);
            line-height: 1;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            color: var(--success-color);
            margin-top: 0.5rem;
        }

        /* Main Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        .chart-container {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
        }

        .target-section {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
        }

        .target-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .progress-ring {
            width: 80px;
            height: 80px;
            position: relative;
        }

        .progress-ring-circle {
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        /* Task Cards */
        .task-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow-sm);
            border-left: 4px solid var(--primary-color);
            transition: all 0.3s ease;
            position: relative;
        }

        .task-card:hover {
            box-shadow: var(--shadow-md);
        }

        .task-card.overdue {
            border-left-color: var(--danger-color);
        }

        .task-card.completed {
            border-left-color: var(--success-color);
            opacity: 0.8;
        }

        .task-card.pending {
            border-left-color: var(--warning-color);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .task-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .task-title.completed {
            text-decoration: line-through;
            color: var(--text-light);
        }

        .task-tag {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary-color);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .task-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .task-detail {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 0.875rem;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }

        .task-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-pending {
            background: rgba(255, 209, 102, 0.2);
            color: #e6a700;
        }

        .status-completed {
            background: rgba(6, 214, 160, 0.2);
            color: var(--success-color);
        }

        .status-overdue {
            background: rgba(239, 71, 111, 0.2);
            color: var(--danger-color);
        }

        /* Form Styles */
        .form-container {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            max-width: 800px;
            margin: 0 auto;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-dark);
        }

        input, select, textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }

        .priority-buttons {
            display: flex;
            gap: 1rem;
        }

        .priority-option {
            flex: 1;
            text-align: center;
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        input[type="radio"]:checked + .priority-option {
            border-color: var(--primary-color);
            background: rgba(67, 97, 238, 0.1);
        }

        .priority-option.low {
            border-color: var(--success-color);
        }

        .priority-option.medium {
            border-color: var(--warning-color);
        }

        .priority-option.high {
            border-color: var(--danger-color);
        }

        /* Button Styles */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--border-color);
            color: var(--text-dark);
        }

        .btn-secondary:hover {
            background: #dee2e6;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #05c391;
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #e03568;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        /* Page Sections */
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        /* Stats Mini */
        .stats-mini {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .stat-mini {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background: rgba(67, 97, 238, 0.05);
            border-radius: var(--border-radius);
        }

        .stat-mini-label {
            font-size: 0.875rem;
            color: var(--text-light);
        }

        .stat-mini-value {
            font-weight: 600;
            color: var(--primary-color);
        }

        /* Filter Buttons */
        .filter-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--border-color);
            background: var(--card-bg);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Task Type Selector */
        .task-type-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--border-color);
        }

        .task-type-btn {
            padding: 1rem 1.5rem;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: var(--text-light);
            transition: all 0.3s ease;
        }

        .task-type-btn.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        /* Recent Activity Styles */
        .activity-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            gap: 1rem;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            font-size: 1.2rem;
            width: 40px;
            text-align: center;
        }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--text-dark);
        }

        .activity-details {
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
            color: var(--text-light);
        }

        .activity-meta {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.25rem;
            font-size: 0.8rem;
        }

        .activity-location, .activity-time-slot {
            background: rgba(67, 97, 238, 0.1);
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            color: var(--primary-color);
        }

        .activity-status {
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .activity-status.status-pending {
            background: rgba(255, 209, 102, 0.2);
            color: #e6a700;
        }

        .activity-status.status-completed {
            background: rgba(6, 214, 160, 0.2);
            color: var(--success-color);
        }

        .activity-status.status-overdue {
            background: rgba(239, 71, 111, 0.2);
            color: var(--danger-color);
        }

        /* Today's Tasks Styles */
        .today-task-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            gap: 1rem;
            transition: all 0.3s ease;
        }

        .today-task-item:hover {
            background: rgba(67, 97, 238, 0.05);
        }

        .today-task-item.completed {
            opacity: 0.7;
            background: rgba(6, 214, 160, 0.05);
        }

        .today-task-item:last-child {
            border-bottom: none;
        }

        .task-time {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 80px;
        }

        .time-slot {
            font-weight: 600;
            color: var(--primary-color);
            font-size: 0.9rem;
        }

        .completed-badge {
            background: var(--success-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            margin-top: 0.25rem;
        }

        .task-info {
            flex: 1;
        }

        .task-info .task-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .task-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
            color: var(--text-light);
            margin-bottom: 0.25rem;
        }

        .task-activity {
            font-size: 0.8rem;
            color: var(--primary-color);
            font-weight: 500;
        }

        /* Weekly Trend Chart Styles */
        .trend-header {
            margin-bottom: 1.5rem;
        }

        .trend-stats {
            display: flex;
            gap: 2rem;
            justify-content: center;
        }

        .trend-stat {
            text-align: center;
        }

        .trend-number {
            display: block;
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .trend-label {
            font-size: 0.875rem;
            color: var(--text-light);
        }

        .chart-bars {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            height: 200px;
            gap: 0.5rem;
        }

        .chart-bar-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .chart-bar {
            width: 30px;
            background: linear-gradient(to top, var(--primary-color), var(--secondary-color));
            border-radius: 4px 4px 0 0;
            transition: all 0.3s ease;
            position: relative;
        }

        .chart-bar:hover {
            transform: scale(1.05);
            background: linear-gradient(to top, var(--primary-dark), var(--secondary-color));
        }

        .chart-label {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: var(--text-light);
            font-weight: 600;
        }

        .chart-count {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-top: 0.25rem;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 2rem;
            color: var(--text-light);
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Search and Sort Controls */
        .search-sort-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            display: flex;
            gap: 0.5rem;
        }

        .sort-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Utility Classes */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .text-center {
            text-align: center;
        }

        .mb-2 {
            margin-bottom: 2rem;
        }

        .mt-2 {
            margin-top: 2rem;
        }

        .w-100 {
            width: 100%;
        }

        .d-flex {
            display: flex;
        }

        .justify-between {
            justify-content: space-between;
        }

        .align-center {
            align-items: center;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .page-content {
                padding: 1rem;
            }
            
            .task-details {
                grid-template-columns: 1fr;
            }
            
            .task-type-selector {
                flex-direction: column;
            }
            
            .filter-buttons {
                flex-direction: column;
            }
            
            .search-sort-controls {
                flex-direction: column;
            }
            
            .top-header {
                padding: 0 1rem;
            }
        }

        /* Additional styles for edit/delete functionality */
        .activity-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
            opacity: 1; /* Always visible for better UX */
        }

        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }

        .btn-edit {
            background: #ffc107;
            color: #000;
        }

        .btn-edit:hover {
            background: #e0a800;
            transform: translateY(-1px);
        }

        .btn-delete {
            background: #dc3545;
            color: white;
        }

        .btn-delete:hover {
            background: #c82333;
            transform: translateY(-1px);
        }

        .records-table .actions-cell {
            white-space: nowrap;
        }

        .task-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .event-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
    </style>
</head>

<body>
    <!-- Skip Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Sidebar Navigation -->
    <nav class="sidebar" role="navigation" aria-label="Main navigation">
        <div class="sidebar-header">
            <h1>üìö Campus Planner</h1>
            <p>Academic Task Management</p>
        </div>
        <ul class="nav-menu">
            <li>
                <a href="#dashboard" class="nav-link active" data-page="dashboard">
                    <span class="nav-icon">üìä</span>
                    Dashboard
                </a>
            </li>
            <li>
                <a href="#tasks" class="nav-link" data-page="tasks">
                    <span class="nav-icon">üìã</span>
                    My Tasks
                </a>
            </li>
            <li>
                <a href="#add-task" class="nav-link" data-page="add-task">
                    <span class="nav-icon">‚ûï</span>
                    Add Task
                </a>
            </li>
            <li>
                <a href="#events" class="nav-link" data-page="events">
                    <span class="nav-icon">üéâ</span>
                    Campus Events
                </a>
            </li>
            <li>
                <a href="#classes" class="nav-link" data-page="classes">
                    <span class="nav-icon">üè´</span>
                    My Classes
                </a>
            </li>
            <li>
                <a href="#settings" class="nav-link" data-page="settings">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    Settings
                </a>
            </li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content" id="main-content">
        <!-- Top Header -->
        <header class="top-header">
            <div class="header-title">
                <h2 id="current-page-title">Dashboard</h2>
            </div>
            <div class="header-actions">
                <div class="user-profile">
                    <div class="user-avatar">SD</div>
                    <div class="user-info">
                        <div class="user-name">Student Developer</div>
                        <div class="user-role">Computer Science</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Page Content -->
        <div class="page-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="page-section active" role="region" aria-labelledby="dashboard-heading">
                <div class="dashboard-header">
                    <h1 id="dashboard-heading">Academic Dashboard</h1>
                    <p>Overview of your academic progress and upcoming deadlines</p>
                </div>

                <!-- Quick Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">üìö</div>
                            <div class="stat-content">
                                <div class="stat-number" id="total-tasks">0</div>
                                <div class="stat-label">Total Tasks</div>
                                <div class="stat-trend">üìà Active this week</div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-header">
                            <div class="stat-icon">‚è±Ô∏è</div>
                            <div class="stat-content">
                                <div class="stat-number" id="total-duration">0m</div>
                                <div class="stat-label">Time Planned</div>
                                <div class="stat-trend">üïí Loading...</div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-header">
                            <div class="stat-icon">‚úÖ</div>
                            <div class="stat-content">
                                <div class="stat-number" id="completed-tasks">0</div>
                                <div class="stat-label">Completed</div>
                                <div class="stat-trend">üéØ Ready to start</div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-header">
                            <div class="stat-icon">üìÖ</div>
                            <div class="stat-content">
                                <div class="stat-number" id="overdue-tasks">0</div>
                                <div class="stat-label">Overdue</div>
                                <div class="stat-trend">üö® Needs attention</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Dashboard Content -->
                <div class="dashboard-grid">
                    <div class="dashboard-main">
                        <!-- Today's Schedule -->
                        <div class="chart-container mb-2">
                            <h3>üìÖ Today's Schedule</h3>
                            <div id="todays-tasks">
                                <p>Loading today's schedule...</p>
                            </div>
                        </div>

                        <!-- Recent Tasks -->
                        <div class="chart-container mb-2">
                            <div class="d-flex justify-between align-center">
                                <h3>üìã Recent Tasks</h3>
                                <div class="filter-buttons">
                                    <button class="filter-btn active" data-filter="all">All</button>
                                    <button class="filter-btn" data-filter="pending">Pending</button>
                                    <button class="filter-btn" data-filter="completed">Completed</button>
                                    <button class="filter-btn" data-filter="overdue">Overdue</button>
                                </div>
                            </div>
                            <div id="recent-tasks">
                                <p>Loading tasks...</p>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-sidebar">
                        <!-- Weekly Activity Trend -->
                        <div class="chart-container mb-2">
                            <h3>üìà Weekly Activity Trend</h3>
                            <div class="trend-chart" id="trend-chart">
                                <p>Loading weekly trend...</p>
                            </div>
                        </div>

                        <!-- Recent Activity -->
                        <div class="chart-container mb-2">
                            <h3>üîÑ Recent Activity</h3>
                            <div id="recent-activity">
                                <p>Loading recent activity...</p>
                            </div>
                        </div>

                        <!-- Daily Target -->
                        <div class="target-section">
                            <div class="target-header">
                                <h3>üéØ Daily Study Target</h3>
                                <div class="progress-ring">
                                    <svg class="progress-ring" width="80" height="80">
                                        <circle class="progress-ring-circle" stroke="#4361ee" stroke-width="8" 
                                                fill="transparent" r="36" cx="40" cy="40" stroke-dasharray="226.194" 
                                                stroke-dashoffset="226.194">
                                        </circle>
                                    </svg>
                                    <div class="progress-text" id="progress-percent">0%</div>
                                </div>
                            </div>
                            <div class="target-controls">
                                <label for="daily-target">Daily target (minutes):</label>
                                <input type="number" id="daily-target" value="240" min="0">
                                <button class="btn btn-primary mt-2 w-100" id="update-target">Update Goal</button>
                            </div>
                            <div id="target-status" class="mt-2">
                                <p>Set your daily study target to get started.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tasks Section -->
            <section id="tasks" class="page-section" role="region" aria-labelledby="tasks-heading">
                <div class="dashboard-header">
                    <h1 id="tasks-heading">My Tasks & Assignments</h1>
                    <p>Manage all your academic tasks and deadlines in one place</p>
                </div>

                <div class="search-sort-controls chart-container mb-2">
                    <div class="search-box">
                        <label for="search-input" class="visually-hidden">Search tasks</label>
                        <input type="text" id="search-input" placeholder="Search tasks...">
                        <button id="search-toggle" class="btn btn-secondary" aria-pressed="false">
                            <span class="toggle-icon">üî§</span> Case Sensitive
                        </button>
                    </div>
                    
                    <div class="sort-controls">
                        <label for="sort-select">Sort by:</label>
                        <select id="sort-select">
                            <option value="dueDate-desc">Due Date (Newest)</option>
                            <option value="dueDate-asc">Due Date (Oldest)</option>
                            <option value="title-asc">Title (A-Z)</option>
                            <option value="title-desc">Title (Z-A)</option>
                            <option value="duration-desc">Duration (Longest)</option>
                            <option value="duration-asc">Duration (Shortest)</option>
                            <option value="status">Status</option>
                        </select>
                    </div>
                </div>

                <div class="filter-buttons mb-2">
                    <button class="filter-btn active" data-filter="all">All Tasks</button>
                    <button class="filter-btn" data-filter="pending">üïí Pending</button>
                    <button class="filter-btn" data-filter="completed">‚úÖ Completed</button>
                    <button class="filter-btn" data-filter="overdue">‚ö†Ô∏è Overdue</button>
                    <button class="filter-btn" data-filter="today">üéØ Today</button>
                </div>

                <div id="tasks-container" role="region" aria-live="polite">
                    <p>Loading tasks...</p>
                </div>
            </section>

            <!-- Add Task Section -->
            <section id="add-task" class="page-section" role="region" aria-labelledby="add-task-heading">
                <div class="dashboard-header">
                    <h1 id="add-task-heading">Add New Item</h1>
                    <p>Create tasks, events, classes, or assignments</p>
                </div>

                <div class="task-type-selector mb-2">
                    <button class="task-type-btn active" data-type="task">üìù Task/Assignment</button>
                    <button class="task-type-btn" data-type="event">üéâ Campus Event</button>
                    <button class="task-type-btn" data-type="class">üè´ Class Schedule</button>
                </div>

                <div class="form-container">
                    <form id="task-form" class="task-form" novalidate>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="item-title">Title *</label>
                                <input type="text" id="item-title" placeholder="e.g., Complete Calculus Homework" required>
                                <div class="error-message" id="title-error" role="alert"></div>
                            </div>

                            <div class="form-group">
                                <label for="item-type">Type *</label>
                                <select id="item-type" required>
                                    <option value="Assignment">Assignment</option>
                                    <option value="Study">Study Session</option>
                                    <option value="Project">Project</option>
                                    <option value="Exam">Exam</option>
                                    <option value="Quiz">Quiz</option>
                                    <option value="Meeting">Meeting</option>
                                    <option value="Event">Campus Event</option>
                                    <option value="Class">Class</option>
                                    <option value="Personal">Personal</option>
                                </select>
                                <div class="error-message" id="type-error" role="alert"></div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="item-dueDate">Due Date *</label>
                                <input type="date" id="item-dueDate" required>
                                <div class="error-message" id="dueDate-error" role="alert"></div>
                            </div>

                            <div class="form-group">
                                <label for="item-duration">Duration (minutes) *</label>
                                <input type="number" id="item-duration" min="15" step="15" placeholder="e.g., 120" required>
                                <div class="error-message" id="duration-error" role="alert"></div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="item-time">Time (Optional)</label>
                                <input type="time" id="item-time">
                            </div>

                            <div class="form-group">
                                <label for="item-building">Building (Optional)</label>
                                <input type="text" id="item-building" placeholder="e.g., Science Building">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="item-room">Room (Optional)</label>
                                <input type="text" id="item-room" placeholder="e.g., Room 301">
                            </div>

                            <div class="form-group">
                                <label for="item-activity">Activity Type</label>
                                <select id="item-activity">
                                    <option value="Study Session">Study Session</option>
                                    <option value="Lab Work">Lab Work</option>
                                    <option value="Group Study">Group Study</option>
                                    <option value="Project Work">Project Work</option>
                                    <option value="Reading">Reading</option>
                                    <option value="Writing">Writing</option>
                                    <option value="Research">Research</option>
                                    <option value="Presentation">Presentation</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="item-priority">Priority Level</label>
                            <div class="priority-buttons">
                                <input type="radio" id="priority-low" name="priority" value="low" checked>
                                <label for="priority-low" class="priority-option low">Low</label>
                                
                                <input type="radio" id="priority-medium" name="priority" value="medium">
                                <label for="priority-medium" class="priority-option medium">Medium</label>
                                
                                <input type="radio" id="priority-high" name="priority" value="high">
                                <label for="priority-high" class="priority-option high">High</label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="item-description">Description (Optional)</label>
                            <textarea id="item-description" placeholder="Any additional details about this item..." rows="3"></textarea>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Create Item</button>
                            <button type="reset" class="btn btn-secondary">Clear Form</button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Events Section -->
            <section id="events" class="page-section" role="region" aria-labelledby="events-heading">
                <div class="dashboard-header">
                    <h1 id="events-heading">Campus Events</h1>
                    <p>Manage campus events, workshops, and social activities</p>
                </div>

                <div class="chart-container">
                    <div class="text-center">
                        <h3>üéâ Campus Events</h3>
                        <p>Create and manage campus events, workshops, and social activities</p>
                        <button class="btn btn-primary mt-2" onclick="showPage('add-task')">Create New Event</button>
                    </div>
                </div>
            </section>

            <!-- Classes Section -->
            <section id="classes" class="page-section" role="region" aria-labelledby="classes-heading">
                <div class="dashboard-header">
                    <h1 id="classes-heading">My Classes</h1>
                    <p>Manage your class schedule and course information</p>
                </div>

                <div class="chart-container">
                    <div class="text-center">
                        <h3>üè´ Class Schedule</h3>
                        <p>Add and manage your classes, schedules, and course details</p>
                        <button class="btn btn-primary mt-2" onclick="showPage('add-task')">Add New Class</button>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="page-section" role="region" aria-labelledby="settings-heading">
                <div class="dashboard-header">
                    <h1 id="settings-heading">Application Settings</h1>
                    <p>Customize your Campus Life Planner experience</p>
                </div>

                <div class="form-container">
                    <div class="form-group">
                        <label for="time-unit">Display duration in:</label>
                        <select id="time-unit">
                            <option value="minutes">Minutes</option>
                            <option value="hours">Hours</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <h3>Data Management</h3>
                        <div class="data-actions">
                            <button id="export-data" class="btn btn-primary">Export Data as JSON</button>
                            <button id="import-trigger" class="btn btn-secondary">Import Data</button>
                            <input type="file" id="import-file" accept=".json" class="visually-hidden">
                            <button id="clear-data" class="btn btn-danger">Clear All Data</button>
                        </div>
                        <div id="import-status" role="status" aria-live="polite"></div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Edit Task Modal -->
    <dialog id="edit-modal" role="dialog" aria-labelledby="edit-modal-heading">
        <div class="form-container">
            <h3 id="edit-modal-heading">Edit Task</h3>
            <form id="edit-form">
                <input type="hidden" id="edit-id">
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-title">Task Title</label>
                        <input type="text" id="edit-title" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-type">Type</label>
                        <select id="edit-type" required>
                            <option value="Assignment">Assignment</option>
                            <option value="Study">Study Session</option>
                            <option value="Project">Project</option>
                            <option value="Exam">Exam</option>
                            <option value="Quiz">Quiz</option>
                            <option value="Meeting">Meeting</option>
                            <option value="Event">Campus Event</option>
                            <option value="Class">Class</option>
                            <option value="Personal">Personal</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-dueDate">Due Date</label>
                        <input type="date" id="edit-dueDate" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-duration">Duration (minutes)</label>
                        <input type="number" id="edit-duration" min="15" step="15" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-time">Time</label>
                        <input type="time" id="edit-time">
                    </div>
                    <div class="form-group">
                        <label for="edit-building">Building</label>
                        <input type="text" id="edit-building" placeholder="e.g., Science Building">
                    </div>
                </div>
                <div class="form-group">
                    <label for="edit-status">Status</label>
                    <select id="edit-status">
                        <option value="pending">Pending</option>
                        <option value="completed">Completed</option>
                        <option value="overdue">Overdue</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                    <button type="button" class="btn btn-secondary" onclick="document.getElementById('edit-modal').close()">Cancel</button>
                </div>
            </form>
        </div>
    </dialog>

    <script>
        // Complete JavaScript functionality - Fixed Version with Edit/Delete
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Campus Life Planner Initializing...');
            
            // Initialize the application
            initializeApp();
            
            // Set up all event listeners
            setupEventListeners();
        });

        // Global state
        let currentTasks = [];
        let currentFilter = 'all';
        let currentSort = 'dueDate-desc';

        function initializeApp() {
            // Load tasks from localStorage or use sample data
            currentTasks = loadTasks();
            
            // Initialize all sections
            updateDashboard();
            renderTasksSection();
            setupAddTaskForm();
            setupSettings();
            
            // Show dashboard by default
            showPage('dashboard');
        }

        function setupEventListeners() {
            // Navigation
            setupNavigation();
            
            // Filters
            setupFilters();
            
            // Search and sort
            setupSearchAndSort();
            
            // Form handlers
            setupForms();
        }

        function loadTasks() {
            const saved = localStorage.getItem('campus-life-planner-data');
            if (saved) {
                return JSON.parse(saved);
            } else {
                // Enhanced sample tasks with times, buildings, and activities
                const sampleTasks = [
                    {
                        id: 'task_1',
                        title: 'Complete Math Assignment',
                        dueDate: getTodayDate(),
                        duration: 120,
                        type: 'Assignment',
                        status: 'pending',
                        priority: 'high',
                        time: '14:00',
                        building: 'Science Building',
                        room: 'Room 301',
                        activityType: 'Study Session',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    },
                    {
                        id: 'task_2', 
                        title: 'Study for Chemistry Quiz',
                        dueDate: getTomorrowDate(),
                        duration: 90,
                        type: 'Study',
                        status: 'pending',
                        priority: 'medium',
                        time: '16:30',
                        building: 'Chemistry Building',
                        room: 'Lab 205',
                        activityType: 'Group Study',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    },
                    {
                        id: 'task_3',
                        title: 'Web Development Project',
                        dueDate: '2024-10-15',
                        duration: 180,
                        type: 'Project',
                        status: 'overdue',
                        priority: 'high',
                        time: '10:00',
                        building: 'Computer Science Building',
                        room: 'Lab 101',
                        activityType: 'Project Work',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    },
                    {
                        id: 'task_4',
                        title: 'Read Chapter 5 - Biology',
                        dueDate: '2024-10-20',
                        duration: 60,
                        type: 'Study',
                        status: 'completed',
                        priority: 'low',
                        time: '09:00',
                        building: 'Library',
                        room: 'Study Room 3',
                        activityType: 'Reading',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    },
                    {
                        id: 'task_5',
                        title: 'Physics Lab Report',
                        dueDate: getTodayDate(),
                        duration: 45,
                        type: 'Lab',
                        status: 'pending',
                        priority: 'medium',
                        time: '13:15',
                        building: 'Physics Building',
                        room: 'Lab 102',
                        activityType: 'Lab Work',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    }
                ];
                localStorage.setItem('campus-life-planner-data', JSON.stringify(sampleTasks));
                return sampleTasks;
            }
        }

        function saveTasks() {
            localStorage.setItem('campus-life-planner-data', JSON.stringify(currentTasks));
        }

        function getTodayDate() {
            return new Date().toISOString().split('T')[0];
        }

        function getTomorrowDate() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            return tomorrow.toISOString().split('T')[0];
        }

        // Navigation Functions
        function setupNavigation() {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    showPage(page);
                });
            });

            // Task type selector
            document.querySelectorAll('.task-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.task-type-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                });
            });
        }

        function showPage(pageName) {
            console.log('Showing page:', pageName);
            
            // Hide all pages
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show target page and activate corresponding nav link
            const targetPage = document.getElementById(pageName);
            if (targetPage) {
                targetPage.classList.add('active');
                
                // Activate corresponding nav link
                const correspondingNav = document.querySelector(`[data-page="${pageName}"]`);
                if (correspondingNav) {
                    correspondingNav.classList.add('active');
                }
                
                // Update page title
                document.getElementById('current-page-title').textContent = 
                    correspondingNav ? correspondingNav.textContent.trim() : pageName;
                
                // Refresh page content if needed
                refreshPageContent(pageName);
            }
        }

        function refreshPageContent(pageName) {
            switch(pageName) {
                case 'dashboard':
                    updateDashboard();
                    break;
                case 'tasks':
                    renderTasksSection();
                    break;
                case 'add-task':
                    // Form is already set up
                    break;
                case 'events':
                    // Placeholder for events
                    break;
                case 'classes':
                    // Placeholder for classes
                    break;
                case 'settings':
                    setupSettings();
                    break;
            }
        }

        // Dashboard Functions
        function updateDashboard() {
            updateStats();
            renderTodaysTasks();
            renderRecentTasks();
            renderRecentActivity();
            updateWeeklyTrend();
        }

        function updateStats() {
            const totalTasks = currentTasks.length;
            const totalDuration = currentTasks.reduce((sum, task) => sum + task.duration, 0);
            const completedTasks = currentTasks.filter(task => task.status === 'completed').length;
            const overdueTasks = currentTasks.filter(task => task.status === 'overdue').length;

            document.getElementById('total-tasks').textContent = totalTasks;
            document.getElementById('total-duration').textContent = totalDuration + 'm';
            document.getElementById('completed-tasks').textContent = completedTasks;
            document.getElementById('overdue-tasks').textContent = overdueTasks;
        }

        function renderTodaysTasks() {
            const container = document.getElementById('todays-tasks');
            if (!container) return;

            const today = getTodayDate();
            const todaysTasks = currentTasks.filter(task => task.dueDate === today)
                .sort((a, b) => (a.time || '00:00').localeCompare(b.time || '00:00'));

            if (todaysTasks.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìÖ</div>
                        <h4>No tasks for today</h4>
                        <p>You're all caught up! Enjoy your day.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = todaysTasks.map(task => `
                <div class="today-task-item ${task.status === 'completed' ? 'completed' : ''}">
                    <div class="task-time">
                        <div class="time-slot">${task.time || 'All day'}</div>
                        ${task.status === 'completed' ? '<div class="completed-badge">‚úì</div>' : ''}
                    </div>
                    <div class="task-info">
                        <h5 class="task-title">${task.title}</h5>
                        <div class="task-meta">
                            <span class="task-type">${task.type}</span>
                            <span class="task-duration">${task.duration} min</span>
                            ${task.building ? `<span class="task-location">${task.building}${task.room ? `, ${task.room}` : ''}</span>` : ''}
                        </div>
                        <div class="task-activity">${task.activityType || 'Academic Work'}</div>
                    </div>
                    <div class="task-actions">
                        <button class="btn btn-sm ${task.status === 'completed' ? 'btn-secondary' : 'btn-success'}" 
                                onclick="toggleTaskStatus('${task.id}')">
                            ${task.status === 'completed' ? 'Undo' : 'Complete'}
                        </button>
                        <button class="btn btn-edit btn-sm" onclick="editTask('${task.id}')">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-delete btn-sm" onclick="deleteTask('${task.id}')">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderRecentTasks() {
            const container = document.getElementById('recent-tasks');
            if (!container) return;

            // Get recent tasks (last 5 created)
            const recentTasks = [...currentTasks]
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 5);

            if (recentTasks.length === 0) {
                container.innerHTML = '<p class="text-center">No tasks yet</p>';
                return;
            }

            container.innerHTML = recentTasks.map(task => createTaskCard(task)).join('');
        }

        function renderRecentActivity() {
            const container = document.getElementById('recent-activity');
            if (!container) return;

            // Sort by updatedAt (most recent first) and take last 5
            const recentActivities = [...currentTasks]
                .sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt))
                .slice(0, 5);

            if (recentActivities.length === 0) {
                container.innerHTML = '<p class="text-center">No recent activity</p>';
                return;
            }

            container.innerHTML = recentActivities.map(task => `
                <div class="activity-item">
                    <div class="activity-icon">
                        ${getActivityIcon(task.status)}
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">${task.title}</div>
                        <div class="activity-details">
                            <span class="activity-type">${task.type}</span>
                            <span class="activity-time">${formatActivityTime(task.updatedAt)}</span>
                        </div>
                        <div class="activity-meta">
                            ${task.building ? `<span class="activity-location">${task.building}</span>` : ''}
                            ${task.time ? `<span class="activity-time-slot">${task.time}</span>` : ''}
                        </div>
                    </div>
                    <div class="activity-actions">
                        <button class="btn btn-edit btn-sm" onclick="editTask('${task.id}')" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-delete btn-sm" onclick="deleteTask('${task.id}')" title="Delete">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function updateWeeklyTrend() {
            const container = document.getElementById('trend-chart');
            if (!container) return;

            // Calculate tasks per day for the last 7 days
            const weekData = getLast7Days();
            const dailyCounts = calculateDailyTaskCounts(currentTasks, weekData);
            
            // Create bar chart
            const maxCount = Math.max(...dailyCounts.map(day => day.count), 1);
            
            container.innerHTML = `
                <div class="trend-header">
                    <div class="trend-stats">
                        <div class="trend-stat">
                            <span class="trend-number">${currentTasks.filter(t => t.dueDate >= weekData[0].date).length}</span>
                            <span class="trend-label">This Week</span>
                        </div>
                        <div class="trend-stat">
                            <span class="trend-number">${dailyCounts.reduce((sum, day) => sum + day.count, 0)}</span>
                            <span class="trend-label">Total Tasks</span>
                        </div>
                    </div>
                </div>
                <div class="chart-bars">
                    ${dailyCounts.map(day => `
                        <div class="chart-bar-container">
                            <div class="chart-bar" 
                                 style="height: ${(day.count / maxCount) * 150}px;"
                                 data-count="${day.count}"
                                 title="${day.dayName}: ${day.count} tasks">
                            </div>
                            <div class="chart-label">${day.dayName}</div>
                            <div class="chart-count">${day.count}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Tasks Section Functions
        function setupFilters() {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');
                    currentFilter = filter;
                    
                    // Update active state
                    this.parentElement.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Re-render tasks
                    renderTasksSection();
                });
            });
        }

        function setupSearchAndSort() {
            const searchInput = document.getElementById('search-input');
            const sortSelect = document.getElementById('sort-select');
            
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    // Implement search functionality here
                    renderTasksSection();
                });
            }
            
            if (sortSelect) {
                sortSelect.addEventListener('change', function() {
                    currentSort = this.value;
                    renderTasksSection();
                });
            }
        }

        function renderTasksSection() {
            const container = document.getElementById('tasks-container');
            if (!container) return;

            let filteredTasks = filterTasks(currentTasks, currentFilter);
            filteredTasks = sortTasks(filteredTasks, currentSort);

            if (filteredTasks.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìù</div>
                        <h4>No tasks found</h4>
                        <p>${currentFilter === 'all' ? 'Create your first task to get started!' : 'No tasks match your current filter.'}</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredTasks.map(task => createTaskCard(task)).join('');
        }

        function filterTasks(tasks, filter) {
            const today = getTodayDate();
            
            switch(filter) {
                case 'completed':
                    return tasks.filter(t => t.status === 'completed');
                case 'pending':
                    return tasks.filter(t => t.status === 'pending');
                case 'overdue':
                    return tasks.filter(t => t.status === 'overdue');
                case 'today':
                    return tasks.filter(t => t.dueDate === today);
                case 'all':
                default:
                    return tasks;
            }
        }

        function sortTasks(tasks, sortType) {
            const [field, order] = sortType.split('-');
            
            return [...tasks].sort((a, b) => {
                let aValue = a[field];
                let bValue = b[field];

                // Handle different field types
                if (field === 'dueDate') {
                    aValue = new Date(aValue);
                    bValue = new Date(bValue);
                } else if (field === 'title') {
                    aValue = aValue.toLowerCase();
                    bValue = bValue.toLowerCase();
                } else if (field === 'duration') {
                    aValue = parseInt(aValue);
                    bValue = parseInt(bValue);
                }

                if (aValue < bValue) return order === 'asc' ? -1 : 1;
                if (aValue > bValue) return order === 'asc' ? 1 : -1;
                return 0;
            });
        }

        // Form Functions
        function setupForms() {
            setupAddTaskForm();
            setupEditForm();
        }

        function setupAddTaskForm() {
            const taskForm = document.getElementById('task-form');
            if (!taskForm) return;

            taskForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = {
                    title: document.getElementById('item-title').value,
                    dueDate: document.getElementById('item-dueDate').value,
                    duration: parseInt(document.getElementById('item-duration').value),
                    type: document.getElementById('item-type').value,
                    priority: document.querySelector('input[name="priority"]:checked').value,
                    description: document.getElementById('item-description').value,
                    time: document.getElementById('item-time').value,
                    building: document.getElementById('item-building').value,
                    room: document.getElementById('item-room').value,
                    activityType: document.getElementById('item-activity').value,
                    status: 'pending'
                };
                
                // Simple validation
                if (!formData.title || !formData.dueDate || !formData.duration || !formData.type) {
                    alert('Please fill in all required fields');
                    return;
                }
                
                addTask(formData);
                taskForm.reset();
                alert('Task added successfully!');
                showPage('tasks');
            });
        }

        function setupEditForm() {
            const editForm = document.getElementById('edit-form');
            if (!editForm) return;

            editForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const taskId = document.getElementById('edit-id').value;
                const updates = {
                    title: document.getElementById('edit-title').value,
                    type: document.getElementById('edit-type').value,
                    dueDate: document.getElementById('edit-dueDate').value,
                    duration: parseInt(document.getElementById('edit-duration').value),
                    status: document.getElementById('edit-status').value,
                    time: document.getElementById('edit-time').value,
                    building: document.getElementById('edit-building').value
                };
                
                updateTask(taskId, updates);
                document.getElementById('edit-modal').close();
                alert('Task updated successfully!');
            });
        }

        function setupSettings() {
            const updateTargetBtn = document.getElementById('update-target');
            if (updateTargetBtn) {
                updateTargetBtn.addEventListener('click', function() {
                    const target = document.getElementById('daily-target').value;
                    alert(`Daily target updated to ${target} minutes`);
                });
            }

            // Add other settings event listeners here
        }

        // Task CRUD Operations
        function addTask(taskData) {
            const newTask = {
                id: 'task_' + Date.now(),
                ...taskData,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            currentTasks.push(newTask);
            saveTasks();
            refreshAllViews();
        }

        function updateTask(taskId, updates) {
            const taskIndex = currentTasks.findIndex(t => t.id === taskId);
            if (taskIndex !== -1) {
                currentTasks[taskIndex] = {
                    ...currentTasks[taskIndex],
                    ...updates,
                    updatedAt: new Date().toISOString()
                };
                saveTasks();
                refreshAllViews();
            }
        }

        function toggleTaskStatus(taskId) {
            const task = currentTasks.find(t => t.id === taskId);
            if (task) {
                task.status = task.status === 'completed' ? 'pending' : 'completed';
                task.updatedAt = new Date().toISOString();
                saveTasks();
                refreshAllViews();
            }
        }

        function editTask(taskId) {
            const task = currentTasks.find(t => t.id === taskId);
            if (task) {
                document.getElementById('edit-id').value = task.id;
                document.getElementById('edit-title').value = task.title;
                document.getElementById('edit-type').value = task.type;
                document.getElementById('edit-dueDate').value = task.dueDate;
                document.getElementById('edit-duration').value = task.duration;
                document.getElementById('edit-status').value = task.status;
                document.getElementById('edit-time').value = task.time || '';
                document.getElementById('edit-building').value = task.building || '';
                document.getElementById('edit-modal').showModal();
            }
        }

        function deleteTask(taskId) {
            if (confirm('Are you sure you want to delete this task?')) {
                currentTasks = currentTasks.filter(t => t.id !== taskId);
                saveTasks();
                refreshAllViews();
                alert('Task deleted successfully!');
            }
        }

        function refreshAllViews() {
            updateDashboard();
            renderTasksSection();
        }

        // Utility Functions
        function createTaskCard(task) {
            const statusClass = getStatusClass(task.status);
            const statusText = getStatusText(task.status);
            const isCompleted = task.status === 'completed';
            
            return `
                <div class="task-card ${statusClass}">
                    <div class="task-header">
                        <div>
                            <h4 class="task-title ${isCompleted ? 'completed' : ''}">${task.title}</h4>
                            <div class="d-flex align-center" style="gap: 0.5rem;">
                                <span class="task-tag">${task.type}</span>
                                <span class="status-badge status-${task.status}">${statusText}</span>
                            </div>
                        </div>
                    </div>
                    <div class="task-details">
                        <div class="task-detail">
                            <span class="detail-label">Due Date</span>
                            <span class="due-date">${new Date(task.dueDate).toLocaleDateString()}</span>
                        </div>
                        <div class="task-detail">
                            <span class="detail-label">Duration</span>
                            <span class="duration">${task.duration} minutes</span>
                        </div>
                        <div class="task-detail">
                            <span class="detail-label">Priority</span>
                            <span class="priority">${task.priority}</span>
                        </div>
                        ${task.time ? `
                        <div class="task-detail">
                            <span class="detail-label">Time</span>
                            <span class="time">${task.time}</span>
                        </div>
                        ` : ''}
                        ${task.building ? `
                        <div class="task-detail">
                            <span class="detail-label">Location</span>
                            <span class="location">${task.building}${task.room ? `, ${task.room}` : ''}</span>
                        </div>
                        ` : ''}
                    </div>
                    <div class="task-actions">
                        <button class="btn btn-success btn-sm" onclick="toggleTaskStatus('${task.id}')">
                            ${task.status === 'completed' ? '‚Ü∂ Undo' : '‚úì Complete'}
                        </button>
                        <button class="btn btn-edit btn-sm" onclick="editTask('${task.id}')">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-delete btn-sm" onclick="deleteTask('${task.id}')">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
            `;
        }

        function getStatusClass(status) {
            switch(status) {
                case 'completed': return 'completed';
                case 'overdue': return 'overdue';
                case 'pending': return 'pending';
                default: return '';
            }
        }

        function getStatusText(status) {
            switch(status) {
                case 'completed': return 'Completed';
                case 'overdue': return 'Overdue';
                case 'pending': return 'Pending';
                default: return status;
            }
        }

        function getActivityIcon(status) {
            switch(status) {
                case 'completed': return '‚úÖ';
                case 'overdue': return '‚ö†Ô∏è';
                case 'pending': return 'üìù';
                default: return 'üìå';
            }
        }

        function formatActivityTime(timestamp) {
            const now = new Date();
            const activityTime = new Date(timestamp);
            const diffMinutes = Math.floor((now - activityTime) / (1000 * 60));
            
            if (diffMinutes < 1) return 'Just now';
            if (diffMinutes < 60) return `${diffMinutes}m ago`;
            if (diffMinutes < 1440) return `${Math.floor(diffMinutes / 60)}h ago`;
            return `${Math.floor(diffMinutes / 1440)}d ago`;
        }

        function getLast7Days() {
            const days = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                days.push({
                    date: date.toISOString().split('T')[0],
                    dayName: date.toLocaleDateString('en-US', { weekday: 'short' })
                });
            }
            return days;
        }

        function calculateDailyTaskCounts(tasks, weekData) {
            return weekData.map(day => {
                const count = tasks.filter(task => task.dueDate === day.date).length;
                return {
                    ...day,
                    count: count
                };
            });
        }

        // Make functions globally available
        window.showPage = showPage;
        window.editTask = editTask;
        window.deleteTask = deleteTask;
        window.toggleTaskStatus = toggleTaskStatus;
    </script>
</body>
</html>
